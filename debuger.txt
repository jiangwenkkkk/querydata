sql is :   SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code
ORDER BY cnt DESCsql is :   SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code
ORDER BY cnt DESCsql is :   SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code
ORDER BY cnt DESCsql is :   SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code
ORDER BY cnt DESCsql is :   SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code
ORDER BY cnt DESCsql is :   SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_codesql is :   SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_codesql is :   SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code
ORDER BY cnt DESCsql is :   SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code
ORDER BY cnt DESCsql is :   SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_codesql is :   SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code2019-01-17 10:07:18sql is :   SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code
ORDER BY cnt DESC
2019-01-17 10:07:19sql is :   SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code
2019-01-17 10:07:19sql is :   SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code
ORDER BY cnt DESC
2019-01-17 10:07:19sql is :   SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code
2019-01-17 10:08:45   sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code
ORDER BY cnt DESC
2019-01-17 10:08:45   sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code
2019-01-17 10:08:45   sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code
ORDER BY cnt DESC
2019-01-17 10:08:46   sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code

2019-01-17 10:09:25   sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code
ORDER BY cnt DESC

2019-01-17 10:09:25   sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code

2019-01-17 10:09:26   sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code
ORDER BY cnt DESC

2019-01-17 10:09:26   sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code

2019-01-17 10:10:42data\query_mode   sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code
ORDER BY cnt DESC

2019-01-17 10:10:42data\query_mode   sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code

2019-01-17 10:10:43data\query_mode   sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code
ORDER BY cnt DESC

2019-01-17 10:10:43data\query_mode   sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code

2019-01-17 10:12:38data\query_mode   sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code
ORDER BY cnt DESC

2019-01-17 10:12:38data\query_mode   sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code

2019-01-17 10:12:38data\query_mode   sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code
ORDER BY cnt DESC

2019-01-17 10:12:39data\query_mode   sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code

2019-01-17 10:13:01data\upload_wrong_bill   sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code
ORDER BY cnt DESC

2019-01-17 10:13:02data\dispatch_wrong_bill   sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code

2019-01-17 10:13:02data\upload_wrong_bill   sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code
ORDER BY cnt DESC

2019-01-17 10:13:02data\dispatch_wrong_bill   sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code

2019-01-17 10:13:33:data\upload_wrong_bill   sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code
ORDER BY cnt DESC

2019-01-17 10:13:33:data\dispatch_wrong_bill   sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code

2019-01-17 10:13:33:data\upload_wrong_bill   sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code
ORDER BY cnt DESC

2019-01-17 10:13:33:data\dispatch_wrong_bill   sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code

2019-01-17 10:14:15: [data\upload_wrong_bill] sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code
ORDER BY cnt DESC

2019-01-17 10:14:16: [data\dispatch_wrong_bill] sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code

2019-01-17 10:14:16: [data\upload_wrong_bill] sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code
ORDER BY cnt DESC

2019-01-17 10:14:16: [data\dispatch_wrong_bill] sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code

[2019-01-17 19:02:37]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn37"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-17 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-17 19:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-17 19:02:39]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn37"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-17 19:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-17 19:02:39]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn37"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 19:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-17 19:02:39]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn37"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 19:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-17 19:03:47]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190117%'
GROUP BY a.PROV_NAME

[2019-01-17 19:07:35]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:07:36]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code

[2019-01-17 19:07:36]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:07:36]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code

[2019-01-17 19:08:27]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:08:27]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code

[2019-01-17 19:08:27]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:08:28]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code

[2019-01-17 19:16:57]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
            AND log_time >= UNIX_TIMESTAMP('2019-01-16 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:16:57]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
       AND log_time >= UNIX_TIMESTAMP('2019-01-16 00:00:00')
      AND log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code

[2019-01-17 19:16:58]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
            AND log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-17 18:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:16:58]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
       AND log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
      AND log_time < UNIX_TIMESTAMP('2019-01-17 18:00:00')
GROUP BY T.err_code

[2019-01-17 19:23:37]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
            AND t.log_time >= UNIX_TIMESTAMP('2019-01-16 00:00:00')
            AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:23:38]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-16 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code

[2019-01-17 19:23:38]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
            AND t.log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
            AND t.log_time < UNIX_TIMESTAMP('2019-01-17 18:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:23:38]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 18:00:00')
GROUP BY T.err_code

[2019-01-17 19:30:25]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:30:26]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-16 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code

[2019-01-17 19:30:26]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 18:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:30:26]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 18:00:00')
GROUP BY T.err_code

[2019-01-17 19:33:16]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:33:16]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code

[2019-01-17 19:33:16]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:33:16]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code

[2019-01-17 19:37:24]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:37:24]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
GROUP BY T.err_code

[2019-01-17 19:37:24]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 01:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:37:24]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
GROUP BY T.err_code

[2019-01-17 19:38:34]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:38:34]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-16 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code

[2019-01-17 19:38:34]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 01:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:38:34]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 01:00:00')
GROUP BY T.err_code

[2019-01-17 19:39:01]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:39:01]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-16 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code

[2019-01-17 19:39:01]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 01:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:39:01]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 01:00:00')
GROUP BY T.err_code

[2019-01-17 19:39:41]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:39:41]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-16 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code

[2019-01-17 19:39:41]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-16 01:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:39:41]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-16 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-16 01:00:00')
GROUP BY T.err_code

[2019-01-17 19:40:12]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:40:12]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-16 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code

[2019-01-17 19:40:13]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-16 19:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:40:13]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-16 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-16 19:00:00')
GROUP BY T.err_code

[2019-01-17 19:41:40]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:41:40]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-16 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code

[2019-01-17 19:41:40]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-16 19:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:41:40]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-16 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-16 19:00:00')
GROUP BY T.err_code

[2019-01-17 19:46:30]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:46:30]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-16 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code

[2019-01-17 19:46:30]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 19:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:46:31]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 19:00:00')
GROUP BY T.err_code

[2019-01-17 19:47:06]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:47:06]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-16 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code

[2019-01-17 19:47:06]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-16 19:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:47:06]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-16 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-16 19:00:00')
GROUP BY T.err_code

[2019-01-17 19:48:35]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:48:35]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-16 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code

[2019-01-17 19:48:35]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 19:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 19:48:35]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 19:00:00')
GROUP BY T.err_code

[2019-01-17 20:09:34]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190116%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-16 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 20:09:34]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190116%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-16 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code

[2019-01-17 20:09:34]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 18:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-17 20:09:34]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-17 18:00:00')
GROUP BY T.err_code

[2019-01-18 08:16:40]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn37"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-17 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-18 00:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-18 08:16:46]: {data\all_average_speed} sql is :  
/* !HINT({"dn":["dn37"]})*/
SELECT
  max(E.output_bill_count / E.all_flow_t),
  min(E.output_bill_count / E.all_flow_t),
  avg(E.output_bill_count / E.all_flow_t) AS average_speed
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')) A
        INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')) B
          ON
            A.input_file = B.input_file) D ON C.input_file = D.input_file) E;


[2019-01-18 08:16:54]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn37"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-18 08:16:54]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn37"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-18 08:16:54]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn37"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-18 08:17:01]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-18 08:17:02]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')
GROUP BY T.err_code

[2019-01-18 08:17:02]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190118%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-18 18:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-18 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-18 08:17:02]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190118%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-18 18:00:00')
GROUP BY T.err_code

[2019-01-18 08:19:33]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190117%'
GROUP BY a.PROV_NAME

[2019-01-18 08:19:34]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn38"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-18 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-18 9:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-18 08:19:35]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn38"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-18 9:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-18 08:19:35]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn38"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-18 9:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-18 08:19:35]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn38"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-18 9:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-18 08:19:40]: {data\all_average_time} sql is :  
/* !HINT({"dn":["dn37"]})*/
SELECT
  max(E.all_flow_t),
  min(E.all_flow_t),
  avg(E.all_flow_t) AS average_time
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')) B ON
                                                                         A.input_file = B.input_file) D
       ON C.input_file = D.input_file) E;


[2019-01-18 08:19:59]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190118%'
GROUP BY a.PROV_NAME

[2019-01-18 08:21:36]: {data\all_time_percent} sql is :  
/* !HINT({"dn":["dn37"]})*/
SELECT
  sum(CASE WHEN all_flow_t < 60
    THEN 1
      ELSE 0 END) AS less60,
  sum(CASE WHEN all_flow_t >= 60 AND all_flow_t < 120
    THEN 1
      ELSE 0 END) AS less120,
  sum(CASE WHEN all_flow_t >= 120
    THEN 1
      ELSE 0 END) AS more120
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')
        ) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')
        ) B
          ON A.input_file = B.input_file) D ON C.input_file = D.input_file) E;

[2019-01-18 08:21:55]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-18 08:21:55]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')
GROUP BY T.err_code

[2019-01-18 08:21:56]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190118%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-18 18:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-18 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-18 08:21:56]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190118%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-18 18:00:00')
GROUP BY T.err_code

[2019-01-18 08:23:26]: {data\part_time_percent} sql is :  
/* !HINT({"dn":["dn37"]})*/
SELECT
  prov,
  sum(CASE WHEN all_flow_t < 60
    THEN 1
      ELSE 0 END) AS less60,
  sum(CASE WHEN all_flow_t >= 60 AND all_flow_t < 120
    THEN 1
      ELSE 0 END) AS less120,
  sum(CASE WHEN all_flow_t >= 120
    THEN 1
      ELSE 0 END) AS more120
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')
        ) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')
        ) B ON
              A.input_file = B.input_file) D ON C.input_file = D.input_file) E
GROUP BY prov
ORDER BY prov;

[2019-01-18 08:25:16]: {data\part_average_time} sql is :  
/* !HINT({"dn":["dn37"]})*/
SELECT
  E.prov,
  max(E.all_flow_t),
  min(E.all_flow_t),
  avg(E.all_flow_t) AS part_average_time
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')) B ON
                                                                         A.input_file = B.input_file) D
       ON C.input_file = D.input_file) E
GROUP BY prov
ORDER BY prov;


[2019-01-18 08:27:07]: {data\part_average_speed} sql is :  
/* !HINT({"dn":["dn37"]})*/
SELECT
  E.prov,
  max(E.output_bill_count / E.all_flow_t),
  min(E.output_bill_count / E.all_flow_t),
  avg(E.output_bill_count / E.all_flow_t) AS average_speed
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')) B ON
                                                                         A.input_file = B.input_file) D
       ON C.input_file = D.input_file) E
GROUP BY prov
ORDER BY prov;

[2019-01-18 19:21:26]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn38"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-18 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-18 18:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-18 19:21:28]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn38"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-18 18:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-18 19:21:28]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn38"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-18 18:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-18 19:21:29]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn38"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-18 18:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-18 19:21:35]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190117%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-17 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-18 19:21:37]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190117%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-17 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-18 00:00:00')
GROUP BY T.err_code

[2019-01-18 19:21:37]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190118%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-18 18:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-18 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-18 19:21:37]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190118%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-18 18:00:00')
GROUP BY T.err_code

[2019-01-18 19:22:30]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190118%'
GROUP BY a.PROV_NAME

[2019-01-19 07:44:31]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn38"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-18 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-19 00:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-19 07:44:36]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn38"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-19 07:44:36]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn38"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-19 07:44:36]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn38"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-19 07:44:39]: {data\all_average_speed} sql is :  
/* !HINT({"dn":["dn38"]})*/
SELECT
  max(E.output_bill_count / E.all_flow_t),
  min(E.output_bill_count / E.all_flow_t),
  avg(E.output_bill_count / E.all_flow_t) AS average_speed
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')) A
        INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')) B
          ON
            A.input_file = B.input_file) D ON C.input_file = D.input_file) E;


[2019-01-19 07:44:45]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190118%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-18 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-19 07:44:46]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190118%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
GROUP BY T.err_code

[2019-01-19 07:44:46]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190119%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 18:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-19 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-19 07:44:47]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190119%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 18:00:00')
GROUP BY T.err_code

[2019-01-19 07:46:46]: {data\all_average_time} sql is :  
/* !HINT({"dn":["dn38"]})*/
SELECT
  max(E.all_flow_t),
  min(E.all_flow_t),
  avg(E.all_flow_t) AS average_time
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')) B ON
                                                                         A.input_file = B.input_file) D
       ON C.input_file = D.input_file) E;


[2019-01-19 07:46:50]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190118%'
GROUP BY a.PROV_NAME

[2019-01-19 07:46:50]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn39"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-19 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-19 9:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-19 07:46:55]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-19 9:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-19 07:46:55]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 9:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-19 07:46:56]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 9:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-19 07:47:24]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190119%'
GROUP BY a.PROV_NAME

[2019-01-19 07:48:32]: {data\all_time_percent} sql is :  
/* !HINT({"dn":["dn38"]})*/
SELECT
  sum(CASE WHEN all_flow_t < 60
    THEN 1
      ELSE 0 END) AS less60,
  sum(CASE WHEN all_flow_t >= 60 AND all_flow_t < 120
    THEN 1
      ELSE 0 END) AS less120,
  sum(CASE WHEN all_flow_t >= 120
    THEN 1
      ELSE 0 END) AS more120
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
        ) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
        ) B
          ON A.input_file = B.input_file) D ON C.input_file = D.input_file) E;

[2019-01-19 07:50:14]: {data\part_time_percent} sql is :  
/* !HINT({"dn":["dn38"]})*/
SELECT
  prov,
  sum(CASE WHEN all_flow_t < 60
    THEN 1
      ELSE 0 END) AS less60,
  sum(CASE WHEN all_flow_t >= 60 AND all_flow_t < 120
    THEN 1
      ELSE 0 END) AS less120,
  sum(CASE WHEN all_flow_t >= 120
    THEN 1
      ELSE 0 END) AS more120
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
        ) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
        ) B ON
              A.input_file = B.input_file) D ON C.input_file = D.input_file) E
GROUP BY prov
ORDER BY prov;

[2019-01-19 07:52:02]: {data\part_average_time} sql is :  
/* !HINT({"dn":["dn38"]})*/
SELECT
  E.prov,
  max(E.all_flow_t),
  min(E.all_flow_t),
  avg(E.all_flow_t) AS part_average_time
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')) B ON
                                                                         A.input_file = B.input_file) D
       ON C.input_file = D.input_file) E
GROUP BY prov
ORDER BY prov;


[2019-01-19 07:53:48]: {data\part_average_speed} sql is :  
/* !HINT({"dn":["dn38"]})*/
SELECT
  E.prov,
  max(E.output_bill_count / E.all_flow_t),
  min(E.output_bill_count / E.all_flow_t),
  avg(E.output_bill_count / E.all_flow_t) AS average_speed
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')) B ON
                                                                         A.input_file = B.input_file) D
       ON C.input_file = D.input_file) E
GROUP BY prov
ORDER BY prov;

[2019-01-19 18:51:12]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190118%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-18 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-19 18:51:13]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190118%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
GROUP BY T.err_code

[2019-01-19 18:51:14]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190119%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 18:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-19 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-19 18:51:14]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190119%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 18:00:00')
GROUP BY T.err_code

[2019-01-19 18:51:37]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn39"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-19 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-19 18:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-19 18:51:41]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-19 18:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-19 18:51:42]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 18:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-19 18:51:43]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 18:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-19 18:52:44]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190119%'
GROUP BY a.PROV_NAME

[2019-01-19 19:00:28]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190118%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-18 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-19 19:00:30]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190118%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
GROUP BY T.err_code

[2019-01-19 19:00:31]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190119%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 19:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-19 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-19 19:00:32]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190119%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 19:00:00')
GROUP BY T.err_code

[2019-01-19 19:00:57]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190118%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-18 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-19 19:00:57]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190118%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-18 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 00:00:00')
GROUP BY T.err_code

[2019-01-19 19:00:57]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190119%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 19:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-19 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-19 19:00:57]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190119%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-19 19:00:00')
GROUP BY T.err_code

[2019-01-20 08:16:22]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190119%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-19 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-20 08:16:23]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190119%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY T.err_code

[2019-01-20 08:16:23]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190120%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 18:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-20 08:16:23]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190120%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 18:00:00')
GROUP BY T.err_code

[2019-01-20 08:16:29]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn39"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-19 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-20 00:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-20 08:16:33]: {data\all_average_speed} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  max(E.output_bill_count / E.all_flow_t),
  min(E.output_bill_count / E.all_flow_t),
  avg(E.output_bill_count / E.all_flow_t) AS average_speed
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')) A
        INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')) B
          ON
            A.input_file = B.input_file) D ON C.input_file = D.input_file) E;


[2019-01-20 08:16:43]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-20 08:16:44]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-20 08:16:44]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-20 08:16:50]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190119%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-19 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-20 08:16:50]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190119%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY T.err_code

[2019-01-20 08:16:50]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190120%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 18:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-20 08:16:51]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190120%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 18:00:00')
GROUP BY T.err_code

[2019-01-20 08:19:05]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190119%'
GROUP BY a.PROV_NAME

[2019-01-20 08:19:05]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn40"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-20 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-20 9:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-20 08:19:06]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-20 9:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-20 08:19:06]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 9:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-20 08:19:06]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 9:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-20 08:19:09]: {data\all_average_time} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  max(E.all_flow_t),
  min(E.all_flow_t),
  avg(E.all_flow_t) AS average_time
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')) B ON
                                                                         A.input_file = B.input_file) D
       ON C.input_file = D.input_file) E;


[2019-01-20 08:19:31]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190120%'
GROUP BY a.PROV_NAME

[2019-01-20 08:20:57]: {data\all_time_percent} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  sum(CASE WHEN all_flow_t < 60
    THEN 1
      ELSE 0 END) AS less60,
  sum(CASE WHEN all_flow_t >= 60 AND all_flow_t < 120
    THEN 1
      ELSE 0 END) AS less120,
  sum(CASE WHEN all_flow_t >= 120
    THEN 1
      ELSE 0 END) AS more120
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
        ) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
        ) B
          ON A.input_file = B.input_file) D ON C.input_file = D.input_file) E;

[2019-01-20 08:22:40]: {data\part_time_percent} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  prov,
  sum(CASE WHEN all_flow_t < 60
    THEN 1
      ELSE 0 END) AS less60,
  sum(CASE WHEN all_flow_t >= 60 AND all_flow_t < 120
    THEN 1
      ELSE 0 END) AS less120,
  sum(CASE WHEN all_flow_t >= 120
    THEN 1
      ELSE 0 END) AS more120
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
        ) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
        ) B ON
              A.input_file = B.input_file) D ON C.input_file = D.input_file) E
GROUP BY prov
ORDER BY prov;

[2019-01-20 08:24:25]: {data\part_average_time} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  E.prov,
  max(E.all_flow_t),
  min(E.all_flow_t),
  avg(E.all_flow_t) AS part_average_time
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')) B ON
                                                                         A.input_file = B.input_file) D
       ON C.input_file = D.input_file) E
GROUP BY prov
ORDER BY prov;


[2019-01-20 08:26:11]: {data\part_average_speed} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  E.prov,
  max(E.output_bill_count / E.all_flow_t),
  min(E.output_bill_count / E.all_flow_t),
  avg(E.output_bill_count / E.all_flow_t) AS average_speed
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')) B ON
                                                                         A.input_file = B.input_file) D
       ON C.input_file = D.input_file) E
GROUP BY prov
ORDER BY prov;

[2019-01-20 10:31:45]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn39"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-19 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-20 00:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-20 10:31:53]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190119%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-19 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-20 10:31:56]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190119%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY T.err_code

[2019-01-20 10:31:56]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190120%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 18:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-20 10:31:57]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190120%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 18:00:00')
GROUP BY T.err_code

[2019-01-20 10:33:02]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-20 10:33:03]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-20 10:33:04]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-20 10:35:26]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190119%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-19 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-20 10:35:29]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190119%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY T.err_code

[2019-01-20 10:35:29]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190120%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 18:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-20 10:35:30]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190120%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 18:00:00')
GROUP BY T.err_code

[2019-01-20 10:37:16]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190119%'
GROUP BY a.PROV_NAME

[2019-01-20 10:37:16]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn40"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-20 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-20 9:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-20 10:37:20]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-20 9:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-20 10:37:20]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 9:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-20 10:37:21]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 9:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-20 10:38:01]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190120%'
GROUP BY a.PROV_NAME

[2019-01-20 10:39:10]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn39"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-19 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-20 00:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-20 10:39:17]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-20 10:39:18]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-20 10:39:18]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-20 10:40:53]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190119%'
GROUP BY a.PROV_NAME

[2019-01-20 10:40:53]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn40"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-20 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-20 9:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-20 10:40:56]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-20 9:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-20 10:40:57]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 9:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-20 10:40:57]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 9:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-20 10:41:36]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190120%'
GROUP BY a.PROV_NAME

[2019-01-20 10:41:44]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn39"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-19 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-20 00:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-20 10:41:48]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-20 10:41:49]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-20 10:41:49]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-20 10:42:04]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn39"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-19 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-20 00:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-20 10:42:08]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-20 10:42:08]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-20 10:42:09]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn39"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-19 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-20 10:43:30]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190119%'
GROUP BY a.PROV_NAME

[2019-01-20 10:43:31]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn40"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-20 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-20 9:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-20 10:43:33]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-20 9:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-20 10:43:34]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 9:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-20 10:43:34]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 9:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-20 10:43:51]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn40"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-20 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-20 18:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-20 10:43:56]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-20 18:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-20 10:43:57]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 18:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-20 10:43:57]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 18:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-20 10:44:45]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn40"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-20 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-20 18:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-20 10:44:49]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-20 18:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-20 10:44:50]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 18:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-20 10:44:50]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-20 18:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-20 10:45:49]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190120%'
GROUP BY a.PROV_NAME

[2019-01-21 11:29:56]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn41"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-21 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-21 18:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-21 11:29:58]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn41"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-21 18:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-21 11:29:58]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn41"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-21 18:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-21 11:29:58]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn41"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-21 18:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-21 11:30:40]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190121%'
GROUP BY a.PROV_NAME

[2019-01-21 14:01:58]: {data\all_average_speed} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  max(E.output_bill_count / E.all_flow_t),
  min(E.output_bill_count / E.all_flow_t),
  avg(E.output_bill_count / E.all_flow_t) AS average_speed
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-21 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-21 00:00:00')) A
        INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-21 00:00:00')) B
          ON
            A.input_file = B.input_file) D ON C.input_file = D.input_file) E;


[2019-01-21 22:54:58]: {data\all_average_speed} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  max(E.output_bill_count / E.all_flow_t),
  min(E.output_bill_count / E.all_flow_t),
  avg(E.output_bill_count / E.all_flow_t) AS average_speed
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-21 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-21 00:00:00')) A
        INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-21 00:00:00')) B
          ON
            A.input_file = B.input_file) D ON C.input_file = D.input_file) E;


[2019-01-21 22:56:18]: {data\all_average_speed} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  max(E.output_bill_count / E.all_flow_t),
  min(E.output_bill_count / E.all_flow_t),
  avg(E.output_bill_count / E.all_flow_t) AS average_speed
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-21 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-21 00:00:00')) A
        INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-21 00:00:00')) B
          ON
            A.input_file = B.input_file) D ON C.input_file = D.input_file) E;


[2019-01-21 22:57:51]: {data\all_average_speed} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  max(E.output_bill_count / E.all_flow_t),
  min(E.output_bill_count / E.all_flow_t),
  avg(E.output_bill_count / E.all_flow_t) AS average_speed
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-21 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-21 00:00:00')) A
        INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-21 00:00:00')) B
          ON
            A.input_file = B.input_file) D ON C.input_file = D.input_file) E;


[2019-01-21 22:58:05]: {data\all_average_speed} sql is :  
/* !HINT({"dn":["dn40"]})*/
SELECT
  max(E.output_bill_count / E.all_flow_t),
  min(E.output_bill_count / E.all_flow_t),
  avg(E.output_bill_count / E.all_flow_t) AS average_speed
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-21 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-21 00:00:00')) A
        INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-21 00:00:00')) B
          ON
            A.input_file = B.input_file) D ON C.input_file = D.input_file) E;


[2019-01-21 22:58:27]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190120%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-21 00:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-21 22:58:27]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190120%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-21 00:00:00')
GROUP BY T.err_code

[2019-01-21 22:58:27]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190121%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-21 18:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-21 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-21 22:58:28]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190121%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-21 18:00:00')
GROUP BY T.err_code

[2019-01-21 22:59:12]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn41"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-21 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-21 18:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-21 22:59:14]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn41"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-21 18:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-21 22:59:14]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn41"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-21 18:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-21 22:59:14]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn41"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-21 18:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-21 22:59:59]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190121%'
GROUP BY a.PROV_NAME

[2019-01-21 23:01:31]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn41"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-21 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-21 18:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-21 23:01:32]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn41"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-21 18:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-21 23:01:32]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn41"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-21 18:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-21 23:01:32]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn41"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-21 18:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-21 23:02:18]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190121%'
GROUP BY a.PROV_NAME

[2019-01-21 23:02:20]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190120%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-21 00:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-20 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-21 23:02:20]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190120%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-20 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-21 00:00:00')
GROUP BY T.err_code

[2019-01-21 23:02:20]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190121%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-21 18:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-21 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-21 23:02:20]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190121%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-21 18:00:00')
GROUP BY T.err_code

[2019-01-21 23:02:27]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn41"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-21 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-21 18:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-21 23:02:28]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn41"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-21 18:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-21 23:02:28]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn41"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-21 18:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-21 23:02:28]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn41"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-21 18:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-21 23:03:14]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190121%'
GROUP BY a.PROV_NAME

[2019-01-22 22:25:36]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190121%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-22 00:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-21 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-22 22:25:37]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190121%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-22 00:00:00')
GROUP BY T.err_code

[2019-01-22 22:25:37]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190122%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-22 21:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-22 22:25:37]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190122%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')
GROUP BY T.err_code

[2019-01-22 22:26:54]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn42"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-22 21:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-22 22:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-22 22:26:55]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-22 22:26:55]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-22 22:26:55]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-22 22:27:10]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190122%'
GROUP BY a.PROV_NAME

[2019-01-22 22:29:36]: {data\all_average_speed} sql is :  
/* !HINT({"dn":["dn41"]})*/
SELECT
  max(E.output_bill_count / E.all_flow_t),
  min(E.output_bill_count / E.all_flow_t),
  avg(E.output_bill_count / E.all_flow_t) AS average_speed
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-22 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-22 00:00:00')) A
        INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-22 00:00:00')) B
          ON
            A.input_file = B.input_file) D ON C.input_file = D.input_file) E;


[2019-01-22 22:32:57]: {data\all_average_time} sql is :  
/* !HINT({"dn":["dn41"]})*/
SELECT
  max(E.all_flow_t),
  min(E.all_flow_t),
  avg(E.all_flow_t) AS average_time
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-22 00:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-22 00:00:00')) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-21 00:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-22 00:00:00')) B ON
                                                                         A.input_file = B.input_file) D
       ON C.input_file = D.input_file) E;


[2019-01-22 22:35:33]: {data\all_average_speed} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  max(E.output_bill_count / E.all_flow_t),
  min(E.output_bill_count / E.all_flow_t),
  avg(E.output_bill_count / E.all_flow_t) AS average_speed
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')) A
        INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')) B
          ON
            A.input_file = B.input_file) D ON C.input_file = D.input_file) E;


[2019-01-22 22:36:39]: {data\all_average_time} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  max(E.all_flow_t),
  min(E.all_flow_t),
  avg(E.all_flow_t) AS average_time
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')) B ON
                                                                         A.input_file = B.input_file) D
       ON C.input_file = D.input_file) E;


[2019-01-22 22:37:01]: {data\all_time_percent} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  sum(CASE WHEN all_flow_t < 60
    THEN 1
      ELSE 0 END) AS less60,
  sum(CASE WHEN all_flow_t >= 60 AND all_flow_t < 120
    THEN 1
      ELSE 0 END) AS less120,
  sum(CASE WHEN all_flow_t >= 120
    THEN 1
      ELSE 0 END) AS more120
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')
        ) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')
        ) B
          ON A.input_file = B.input_file) D ON C.input_file = D.input_file) E;

[2019-01-22 22:37:18]: {data\part_time_percent} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  prov,
  sum(CASE WHEN all_flow_t < 60
    THEN 1
      ELSE 0 END) AS less60,
  sum(CASE WHEN all_flow_t >= 60 AND all_flow_t < 120
    THEN 1
      ELSE 0 END) AS less120,
  sum(CASE WHEN all_flow_t >= 120
    THEN 1
      ELSE 0 END) AS more120
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')
        ) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')
        ) B ON
              A.input_file = B.input_file) D ON C.input_file = D.input_file) E
GROUP BY prov
ORDER BY prov;

[2019-01-22 22:37:35]: {data\part_average_time} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  E.prov,
  max(E.all_flow_t),
  min(E.all_flow_t),
  avg(E.all_flow_t) AS part_average_time
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')) B ON
                                                                         A.input_file = B.input_file) D
       ON C.input_file = D.input_file) E
GROUP BY prov
ORDER BY prov;


[2019-01-22 22:37:52]: {data\part_average_speed} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  E.prov,
  max(E.output_bill_count / E.all_flow_t),
  min(E.output_bill_count / E.all_flow_t),
  avg(E.output_bill_count / E.all_flow_t) AS average_speed
FROM
  (SELECT
     D.input_file,
     D.output_bill_count,
     D.output_errcdr_count,
     D.prov,
     FROM_UNIXTIME(D.create_time)      create_time,
     FROM_UNIXTIME(D.input_time)       input_time,
     FROM_UNIXTIME(D.output_time)      output_time,
     FROM_UNIXTIME(C.dis_min_time)     dis_min_time,
     FROM_UNIXTIME(C.dis_max_time)     dis_max_time,
     (C.dis_max_time - D.create_time)  all_flow_t,
     (C.dis_max_time - C.dis_min_time) dispat_t,
     (D.output_time - D.create_time)   distri_t,
     (D.input_time - D.create_time)    find_t
   FROM
     (SELECT
        MAX(Handleendtime)  dis_max_time,
        MIN(Handlestattime) dis_min_time,
        input_file
      FROM history_log_1
      WHERE module_id = 2
            AND log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
            AND log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')
      GROUP BY input_file) C INNER JOIN
     (SELECT
        A.input_file     input_file,
        A.create_time    create_time,
        B.Handlestattime input_time,
        B.Handleendtime  output_time,
        B.output_bill_count,
        B.output_errcdr_count,
        B.prov
      FROM
        (SELECT
           input_file,
           create_time,
           Handlestattime
         FROM history_log_1
         WHERE log_type = 1
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')) A INNER JOIN
        (SELECT
           input_file,
           Handlestattime,
           Handleendtime,
           output_bill_count,
           output_errcdr_count,
           SUBSTRING(input_file, 16, 3) prov
         FROM history_log_1
         WHERE log_type = 3
               AND module_id = 1
               AND log_time >= UNIX_TIMESTAMP('2019-01-22 21:00:00')
               AND log_time < UNIX_TIMESTAMP('2019-01-22 22:00:00')) B ON
                                                                         A.input_file = B.input_file) D
       ON C.input_file = D.input_file) E
GROUP BY prov
ORDER BY prov;

[2019-01-23 09:48:59]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn42"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-22 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-22 24:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-23 09:49:06]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-22 24:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-23 09:49:07]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-22 24:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-23 09:49:07]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-22 24:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-23 09:49:27]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190122%'
GROUP BY a.PROV_NAME

[2019-01-23 09:51:57]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn42"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3

group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-23 09:51:59]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-22 23:59:59')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-23 09:51:59]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-22 23:59:59')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-23 09:51:59]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-22 23:59:59')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-23 09:52:47]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190122%'
GROUP BY a.PROV_NAME

[2019-01-23 09:56:27]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190122%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-23 00:00:00')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-22 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-23 09:56:27]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190122%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-23 00:00:00')
GROUP BY T.err_code

[2019-01-23 09:56:27]: {data\upload_wrong_bill} sql is :  
SELECT
  T.err_code,
  COUNT(1) AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") as pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNIG'
      AND T.file_name LIKE '%20190122%'
      AND t.log_time < UNIX_TIMESTAMP('2019-01-22 23:59:59')
      AND t.log_time > UNIX_TIMESTAMP('2019-01-22 00:00:00')
GROUP BY T.err_code
ORDER BY cnt DESC

[2019-01-23 09:56:27]: {data\dispatch_wrong_bill} sql is :  
SELECT
  t.err_code,
  COUNT(1)                                         AS cnt,
  GROUP_CONCAT(DISTINCT a.PROV_NAME SEPARATOR "/") AS pro
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND T.file_name LIKE '%20190122%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-22 23:59:59')
GROUP BY T.err_code

[2019-01-23 10:23:31]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn42"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-22 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-22 23:59:59')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-23 10:23:32]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-22 23:59:59')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-23 10:23:32]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-22 23:59:59')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-23 10:23:32]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-22 23:59:59')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-23 10:24:21]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190122%'
GROUP BY a.PROV_NAME

[2019-01-23 10:32:14]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn42"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-22 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-22 23:59:59')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-23 10:32:16]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-22 23:59:59')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-23 10:32:16]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-22 23:59:59')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-23 10:32:16]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-22 23:59:59')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-23 10:33:03]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190122%'
GROUP BY a.PROV_NAME

[2019-01-23 10:47:02]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn42"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
and t.log_time >=UNIX_TIMESTAMP('2019-01-22 00:00:00')
and t.log_time <UNIX_TIMESTAMP('2019-01-22 23:59:59')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-23 10:47:03]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-22 23:59:59')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-23 10:47:03]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-22 23:59:59')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-23 10:47:03]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-22 23:59:59')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-23 10:47:52]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190122%'
GROUP BY a.PROV_NAME

[2019-01-23 10:51:18]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn42"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3

group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-23 10:51:19]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 00:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-22 23:59:59')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-23 10:51:19]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-22 23:59:59')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-23 10:51:19]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn42"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-22 00:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-22 23:59:59')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-23 10:52:06]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190122%'
GROUP BY a.PROV_NAME

[2019-01-27 11:07:01]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3

group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 11:07:03]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-27 11:07:03]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-27 11:07:03]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-27 11:07:11]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190127%'
GROUP BY a.PROV_NAME

[2019-01-27 11:07:47]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3

group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 11:07:48]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-27 11:07:48]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-27 11:07:48]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-27 11:07:56]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190127%'
GROUP BY a.PROV_NAME

[2019-01-27 11:21:24]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 11:21:25]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-27 11:21:25]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-27 11:21:25]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-27 11:21:33]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190127%'
GROUP BY a.PROV_NAME

[2019-01-27 16:37:56]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 16:38:58]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 16:39:49]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 16:40:05]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 16:40:38]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 16:41:49]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 16:41:50]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-27 16:41:50]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-27 16:41:50]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-27 16:42:01]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190127%'
GROUP BY a.PROV_NAME

[2019-01-27 16:45:25]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 16:45:26]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-27 16:45:26]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-27 16:45:26]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-27 16:45:37]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190127%'
GROUP BY a.PROV_NAME

[2019-01-27 16:48:25]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 16:48:26]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-27 16:48:27]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-27 16:48:27]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-27 16:48:37]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190127%'
GROUP BY a.PROV_NAME

[2019-01-27 16:51:32]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 16:51:33]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-27 16:51:33]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-27 16:51:33]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-27 16:51:43]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190127%'
GROUP BY a.PROV_NAME

[2019-01-27 16:51:58]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 16:54:29]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 16:54:30]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-27 16:54:30]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-27 16:54:31]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-27 16:54:42]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190127%'
GROUP BY a.PROV_NAME

[2019-01-27 17:20:09]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 17:20:10]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-27 17:20:11]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-27 17:20:11]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-27 17:20:22]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190127%'
GROUP BY a.PROV_NAME

[2019-01-27 17:21:23]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 17:23:14]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 17:23:15]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-27 17:23:16]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-27 17:23:16]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-27 17:24:10]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 17:24:53]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 17:26:26]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 17:27:26]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 17:28:22]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 17:30:05]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 17:37:15]: {data\uploadfile_rightbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
select substr(t.input_file,16,3) as id, count(t.log_id) as file_num, sum(IFNULL(t.output_bill_count,0)) as right_bill_num from  history_log_1 t 
where  t.module_id =1
and t.log_type =3
  AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time <= UNIX_TIMESTAMP('2019-01-27 06:00:00')
group by substr(t.input_file,16,3)
order by substr(t.input_file,16,3)

[2019-01-27 17:37:16]: {data\wrong_bill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  PROV_NAME                             AS '省份',
  PROV_ID,
  count(t.log_id)                       AS wrong_file_num,
  sum(ifnull(t.output_errcdr_count, 0)) AS wrong_bill_num
FROM history_log_1 t
  RIGHT JOIN (SELECT *
              FROM tp_province
              WHERE prov_id NOT IN (1, 199)) a
    ON substr(input_file, 16, 3) = a.prov_id
       AND t.module_id = 1
       AND t.log_type = 3
       AND t.output_file LIKE 'E%'
       AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
       AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY prov_id
ORDER BY prov_id


[2019-01-27 17:37:16]: {data\reject_file} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.input_file, 16, 3) as prov_id,
  count(t.log_id) AS reject_num,
  sum(t.output_errcdr_count)
FROM history_log_1 t
WHERE t.module_id = 1
      AND t.log_type = 3
      AND t.output_file LIKE 'F%'
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY substr(t.input_file, 16, 3)
ORDER BY substr(t.input_file, 16, 3)

[2019-01-27 17:37:16]: {data\dispatchfile_dispatchbill} sql is :  
/* !HINT({"dn":["dn47"]})*/
SELECT
  substr(t.output_file, 16, 3)     roam_out,
  B.prov_name,
  count(DISTINCT t.output_file) AS dispatch_file,
  sum(t.output_bill_count)      AS dispatch_bill
FROM history_log_1 t, tp_province A, tp_province B
WHERE t.module_id = 2
      AND t.log_type = 3
      AND substr(input_file, 16, 3) = A.prov_id
      AND substr(output_file, 16, 3) = B.prov_id
      AND t.log_time >= UNIX_TIMESTAMP('2019-01-27 05:00:00')
      AND t.log_time < UNIX_TIMESTAMP('2019-01-27 06:00:00')
GROUP BY roam_out
ORDER BY roam_out;

[2019-01-27 17:37:27]: {data\own_wrong_bill} sql is :  
SELECT
  a.PROV_NAME AS prov_name,
  COUNT(1)    AS own_wrong_bill
FROM rejecterror_bill_history_1 t, tp_province a
WHERE SUBSTR(t.file_name, 17, 3) = a.prov_id
      AND t.item_type = 'LNDG'
      AND t.file_name LIKE '%20190127%'
GROUP BY a.PROV_NAME
